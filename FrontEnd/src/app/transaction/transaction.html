<!-- Navbar -->
<nav class="navbar">
  <div class="nav-left">
    <a href="#">
      <img src="https://agency.entasher.com/Images/actualsize/2024/5/Logo_847363b7554a46b48559c222f4f9053c.png" alt="Logo" class="logo">
    </a>
    <span class="brand">Finance</span>
  </div>
  <ul class="nav-links">
    <li><a (click)="goHome()">Home</a></li>
    <li><a (click)="goToTransaction()">Transactions</a></li>
    <li><a (click)="goToRecurring()">Recurring Transactions</a></li>
    <li><a *ngIf="isAdmin()" (click)="goToDashboard()">Dashboard</a></li>
    <li><a (click)="goToContact()">Contact Us</a></li>
    <li><a (click)="goToAbout()">About</a></li>
  </ul>
<button class="logout-btn" (click)="goTowelcome()">Logout</button>
</nav>

<div class="container">
  <h2>Transactions</h2>

  <!-- Summary Section -->
  <div class="summary">
    <div class="card income">
      <h3>Total Income</h3>
      <p>{{ totalIncome | currency }}</p>
    </div>
    <div class="card expense">
      <h3>Total Expenses</h3>
      <p>{{ totalExpense | currency }}</p>
    </div>
    <div class="card balance" [ngClass]="{'profit': netBalance >= 0, 'loss': netBalance < 0}">
      <h3>Net Balance</h3>
      <p>{{ netBalance | currency }}</p>
      <span>{{ status }}</span>
    </div>
  </div>

  <!-- Transactions List -->
  <div *ngIf="!showForm">
  <div class="filters">
    <!-- ‚úÖ Date Range -->
    <select [(ngModel)]="filterDate">
      <option value="">Select Date Range</option>
      <option value="today">Today</option>
      <option value="this-week">This Week</option>
      <option value="this-month">This Month</option>
      <option value="last-month">Last Month</option>
      <option value="this-year">This Year</option>
    </select>

    <!-- ‚úÖ Categories -->
    <select [(ngModel)]="filterCategory">
      <option value="">All Categories</option>
      <option value="Food">Food</option>
      <option value="Bills">Bills</option>
      <option value="Entertainment">Entertainment</option>
      <option value="Work">Work</option>
      <option value="Investments">Investments</option>
      <option value="Other">Other</option>
    </select>

    <!-- ‚úÖ Transaction Types -->
    <select [(ngModel)]="filterType">
      <option value="">All Types</option>
      <option value="Income">Income</option>
      <option value="Expense">Expense</option>
    </select>

    <button (click)="addTransaction()" class="btn-add">+ Add Transaction</button>
  </div>


    <table class="transactions-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Description</th>
          <th>Category</th>
          <th>currency</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let t of transactions; let i = index">
          <td>{{ t.date }}</td>
          <td>{{ t.description }}</td>
          <td>{{ t.categoryName }}</td>
          <td>{{ t.currency }}</td>
          <td>
            <span class="badge" [ngClass]="t.type.toLowerCase()">{{ t.type }}</span>
          </td>
          <td [ngClass]="{'red': t.type==='Expense', 'green': t.type==='Income'}">
            {{ t.amount | currency }}
          </td>
          <td>
            <button (click)="editTransaction(i)">‚úèÔ∏è</button>
            <button (click)="deleteTransaction(i)">üóëÔ∏è</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Add / Edit Transaction Form -->
  <div *ngIf="showForm" class="form-container">
    <h2>{{ isEdit ? 'Edit Transaction' : 'Add New Transaction' }}</h2>
    <form [formGroup]="transactionform" (ngSubmit)="saveTransaction(transactionform)">
      <label>Amount</label>
      <input type="number" [(ngModel)]="newTransaction.amount" name="amount" formControlName="amount" required />

      <label>Type</label>
      <select [(ngModel)]="newTransaction.type" name="type" formControlName="type" required >
        <option>Expense</option>
        <option>Income</option>
      </select>

      <label>currency</label>
      <select [(ngModel)]="newTransaction.currency" name="currency" formControlName="currency" required >
        <option>EGP</option>
        <option>EUR</option>
        <option>KWD</option>
      </select>

      <label>Category</label>
<input type="text"
       [(ngModel)]="newTransaction.categoryName"
       name="categoryName"
       formControlName="categoryName" required />


      <label>Date</label>
      <input type="date" [(ngModel)]="newTransaction.date" name="date" formControlName="date" required />

      <label>Description</label>
      <textarea [(ngModel)]="newTransaction.description" name="description" formControlName="description" required ></textarea>

      <div class="actions">
        <button type="button" (click)="cancelForm()">Cancel</button>
        <button type="submit" class="save-btn" >
          {{ isEdit ? 'Update Transaction' : 'Save Transaction' }}
        </button>
      </div>
    </form>
  </div>
</div>
