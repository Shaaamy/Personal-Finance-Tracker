<!-- Navbar -->
<nav class="navbar">
  <div class="nav-left">
    <a href="#">
      <img src="https://agency.entasher.com/Images/actualsize/2024/5/Logo_847363b7554a46b48559c222f4f9053c.png" alt="Logo" class="logo">
    </a>
    <span class="brand">Finance</span>
  </div>
  <ul class="nav-links">
    <li><a (click)="goHome()">Home</a></li>
    <li><a (click)="goToTransaction()">Transactions</a></li>
    <li><a (click)="goToRecurring()">Recurring Transactions</a></li>
    <li><a (click)="goToContact()">Contact Us</a></li>
    <li><a (click)="goToAbout()">About</a></li>
  </ul>
  <button class="logout-btn" (click)="goTowelcome()">Logout</button>
</nav>

<div class="container">
  <h2>Recurring Transactions</h2>

  <!-- üÜï Summary Boxes -->
  <div class="summary-boxes">
    <div class="card daily"><h3>Daily</h3><p>{{ dailyTotal | currency }}</p></div>
    <div class="card weekly"><h3>Weekly</h3><p>{{ weeklyTotal | currency }}</p></div>
    <div class="card monthly"><h3>Monthly</h3><p>{{ monthlyTotal | currency }}</p></div>
    <div class="card half"><h3>Half-Annual</h3><p>{{ halfAnnualTotal | currency }}</p></div>
    <div class="card annual"><h3>Annual</h3><p>{{ annualTotal | currency }}</p></div>
  </div>

  <!-- üÜï Filters (new block inserted) -->
  <div *ngIf="!showForm">
    <div class="filters">
      <!-- Date Range -->
      <select [(ngModel)]="filterDate" (change)="applyFilters()">
        <option value="">Frequancy</option>
        <option value="today">daily</option>
        <option value="this-week">weekly</option>
        <option value="this-month"> Monthly</option>
        <option value="last-month">annual</option>
        <option value="this-year">Half-Annual</option>
      </select>

      <!-- Category -->
      <select [(ngModel)]="filterCategory" (change)="applyFilters()">
        <option value="">All Categories</option>
       <option>Food</option>
        <option>Transport</option>
        <option>Entertainment</option>
        <option>Shopping</option>
        <option>Salary</option>
        <option>Freelance</option>
      </select>

      <!-- Type -->
      <select [(ngModel)]="filterType" (change)="applyFilters()">
        <option value="">Names</option>
        <option>Monthly Rent</option>
        <option>Gym Membership</option>
        <option>Netflix</option>
        <option>Weekly Groceries</option>
        <option>Annual License</option>
      </select>

      

      <!-- Extra Filter -->
      <select [(ngModel)]="filterExtra" (change)="applyFilters()">
        <option value="">Select Option</option>
        <option>All Categories</option>
        <option>Name</option>
        <option>Frequency</option>
      </select>
    </div>
  </div>

  <!-- Search + Add -->
  <div *ngIf="!showForm" class="filters" style="margin-top:15px;">
    <input type="text"
           placeholder="Search by name, category, frequency or amount..."
           [(ngModel)]="searchTerm"
           (input)="applyFilters()"
           class="search-bar" />
    <button (click)="addTransaction()" class="btn-add">+ Add New Transaction</button>
  </div>

  <!-- Table -->
  <h3 *ngIf="!showForm">Upcoming Recurring Transactions</h3>
  <table class="transactions-table" *ngIf="!showForm">
    <thead>
      <tr>
        <th>Name</th><th>Amount</th><th>Category</th><th>Frequency</th><th>Next Occurrence</th><th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let t of filteredTransactions; let i = index">
        <td>{{ t.name }}</td>
        <td class="red">{{ t.amount | currency }}</td>
        <td>{{ t.category }}</td>
        <td>{{ t.frequency }}</td>
        <td>{{ t.nextOccurrence }}</td>
        <td>
          <button (click)="editTransaction(i)">‚úèÔ∏è</button>
          <button (click)="deleteTransaction(i)">üóëÔ∏è</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Form -->
  <div *ngIf="showForm" class="form-container">
    <h2>{{ isEdit ? 'Edit Transaction' : 'Add New Transaction' }}</h2>
    <form #formRef="ngForm">
      <label>Description</label>
      <input type="text" [(ngModel)]="newTransaction.name" name="name" required />

      <label>Amount</label>
      <input type="number" [(ngModel)]="newTransaction.amount" name="amount" required />

      <label>Category</label>
      <input type="text" [(ngModel)]="newTransaction.category" name="category" required />

      <label>Frequency</label>
      <select [(ngModel)]="newTransaction.frequency" name="frequency" required>
        <option>Daily</option><option>Weekly</option><option>Monthly</option>
        <option>Half-Annual</option><option>Annual</option>
      </select>

      <label>Next Payment Date</label>
      <input type="date" [(ngModel)]="newTransaction.nextOccurrence" name="nextOccurrence" required />

      <div class="actions">
        <button type="button" (click)="cancelForm()">Cancel</button>
        <button type="button" class="save-btn" (click)="saveTransaction()" [disabled]="!formRef.valid">
          {{ isEdit ? 'Update Transaction' : 'Save Transaction' }}
        </button>
      </div>
    </form>
  </div>
</div>
